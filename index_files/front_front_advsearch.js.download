;(function($,_,undefined){"use strict";ips.controller.register('advsearch.front.store.search',{_productURL:'',initialize:function(){this.on(document,'contentChange',_.bind(this.contentChange,this));this.setup();this._initializeAdditionalFeatures();},setup:function(){var self=this;this.scope.find('input[name="advSearch"]').on('input',function(){var query=$(this).val();if(query.length===0||query.length>2){self._sendSearchRequest(query);}});},_initializeAdditionalFeatures:function(){const searchTrigger=document.getElementById('elSearch');const ipsApp=document.querySelector('.ipsApp');const searchOverlay=document.querySelector('.search-overlay');this._dataFlow();if(searchTrigger&&ipsApp){searchTrigger.addEventListener('click',()=>{ipsApp.classList.add('elSearchMenu_open');const advSearchInput=document.querySelector('input[name="advSearch"]');if(advSearchInput){setTimeout(()=>{advSearchInput.focus();},100)}});}
if(searchOverlay){searchOverlay.addEventListener('click',()=>{ipsApp.classList.remove('elSearchMenu_open');});}},_dataFlow:function(){const cSearchProducts=document.getElementById('cSearchProducts');setTimeout(()=>{if(cSearchProducts){if(cSearchProducts.offsetHeight>450){cSearchProducts.setAttribute('data-overflow','true');}}},"100");},_sendSearchRequest:function(query){let self=this;let url=self.scope.find('input[name="storePath"]').val();ips.getAjax()(url,{data:{"query":query},type:'post'}).done((response)=>{self._handleSearchResponse(response);}).fail((response)=>{console.error("AJAX request failed:",response);});},_handleSearchResponse:function(response){const cSearchProducts=document.getElementById('cSearchProducts');var resultsContainer=this.scope.find('[data-role="searchResults"]');resultsContainer.empty();if(response&&response.rows!=="\n"){if(response.count>4){cSearchProducts.setAttribute('data-overflow','true');}else{cSearchProducts.setAttribute('data-overflow','false');}
resultsContainer.append(response.rows);}else{resultsContainer.append('<p class="searchError searchError_noResults">No products were found under that search query.</p>');}},contentChange:function(){var self=this;this.scope.find('[data-role="activityItem"]').each(function(){self._processResult($(this));});}});}(jQuery,_));;